# Waves
$n$ is time. $b_0$ and $b_1$ are dissipation terms.
$$D_x=c^2/\Delta x^2$$

$$D_y=c^2/\Delta y^2$$

$$
\frac{u^{n+1}-2u^n+u^{n-1}}{\Delta t^2}+
\frac{b_0}{\Delta t}(u^{n+1}-u^{n-1})+
\frac{b_1}{2\Delta t^3}(u^{n+2}-2u^{n+1}+2u^{n-1}-u^{n-2})=
D_x(u_{x+1}-2u+u_{x-1})+D_y(u_{y+1}-2u+u_{y-1})+f(x,y,t)
$$

$$A=\frac{b_1}{2\Delta t^3}$$
$$B=\frac{1}{\Delta t^2}$$
$$C=\frac{b_0}{\Delta t}$$

$$
B(u^{n+1}-2u^n+u^{n-1})+
C(u^{n+1}-u^{n-1})+
A(u^{n+2}-2u^{n+1}+2u^{n-1}-u^{n-2})=
D_x(u_{x+1}-2u+u_{x-1})+D_y(u_{y+1}-2u+u_{y-1})+f(x,y,t)
$$

$$
Au^{n+2}=
$$
$$
=u^{n+1}(-B-C+2A)+
$$
$$
+u^{n}(2B-2D_x-2D_y)+
$$
$$
+u^{n-1}(-B+C-2A)+
$$
$$
+u^{n-2}(A)+
$$
$$
+D_x(u_{x+1}+u_{x-1})+D_y(u_{y+1}+u_{y-1})+f(x,y,t)
$$
# Intial conditions
$$
\partial u=0, n=0
$$
Note: this probably needs more like 
$$
\frac{\partial^n u}{\partial t^n}=0, n < S
$$

Then
$$
\frac{u^{n+1}-u^{n-1}}{2 \Delta t}=0, n=0
$$

$$
u^{1}=u^{-1}
$$

umm... assume:
$$
u^n=0, n<5
$$

# New idea: backwards thingy for the third degree
$$
\frac{u^{n+1}-2u^n+u^{n-1}}{\Delta t^2}+
\frac{b_0}{\Delta t}(u^{n+1}-u^{n-1})+\\+
\frac{b_1}{2\Delta t^3}(3u^{n+1}-10u^{n}+12u^{n-1}-6u^{n-2}+u^{n-3})=
D_x(u_{x+1}-2u+u_{x-1})+D_y(u_{y+1}-2u+u_{y-1})+f(x,y,t)
$$

$$
u^{n+1}(1/ \Delta t^2+\frac{b_0}{\Delta t}+\frac{3b_1}{2\Delta t^3})=
$$

$$
=u^{n}(2/ \Delta t^2+\frac{5b_1}{\Delta t^3}-2D_x-2D_y)+
$$
$$
+u^{n-1}(-1/ \Delta t^2+\frac{b_0}{\Delta t}-\frac{6b_1}{\Delta t^3})+
$$

$$
+u^{n-2}\frac{3b_1}{\Delta t^3}-
$$
$$
-u^{n-3}\frac{b_1}{2\Delta t^3}+
$$
$$
+D_x(u_{x+1}+u_{x-1})+D_y(u_{y+1}+u_{y-1})+f(x,y,t)
$$


$$
u^{n+1}(1/ \Delta t+b_0+\frac{3b_1}{2\Delta t^2})=
$$

$$
=u^{n}(2/ \Delta t+\frac{5b_1}{\Delta t^2}-\Delta t 2D_x-\Delta t 2D_y)+
$$
$$
+u^{n-1}(-1/ \Delta t+b_0-\frac{6b_1}{\Delta t^2})+
$$

$$
+u^{n-2}\frac{3b_1}{\Delta t^2}-
$$
$$
-u^{n-3}\frac{b_1}{2\Delta t^2}+
$$
$$
+\Delta t (D_x(u_{x+1}+u_{x-1})+D_y(u_{y+1}+u_{y-1})+f(x,y,t))
$$
# Strongly dampened waves

$$Au_{tt}-B\Delta u-C\Delta u_t-f(x,t)=0$$
$$u_{tt}-{B\over A}\Delta u-{C\over A}\Delta u_t-f(x,t)=0$$
$$u_{tt}-D\Delta u-E\Delta u_t-f(x,t)=0$$
$$\frac{\partial^2 u}{ \partial t^2} - D\frac{\partial^2 u}{ \partial x^2}-D\frac{\partial^2 u}{ \partial y^2}-E\frac{\partial^3 u}{\partial t \partial x^2}-E\frac{\partial^3 u}{\partial t \partial y^2}-f(x,t)=0$$

If $E=0$ we go back to first equation.

$$\frac{u^{n+1}-2u^n+u^{n-1}}{\Delta t^2}-\frac{D}{\Delta x^2}(u^n_{x+1}-2u^n+u^n_{x-1})-\frac{D}{\Delta y^2}(u^n_{y+1}-2u^n+u^n_{y-1})-\\
\frac{E}{2\Delta x^2\Delta t}(u^{n+1}_{x+1}-2u^{n+1}+u^{n+1}_{x-1})+\frac{E}{2\Delta x^2\Delta t}(u^{n-1}_{x+1}-2u^{n-1}+u^{n-1}_{x-1})-\\
\frac{E}{2\Delta y^2\Delta t}(u^{n+1}_{y+1}-2u^{n+1}+u^{n+1}_{y-1})+
\frac{E}{2\Delta y^2\Delta t}(u^{n-1}_{y+1}-2u^{n-1}+u^{n-1}_{y-1})-f(x,y)=0$$

$$u^{n+1}(1+\frac{E\Delta t}{\Delta y^2}+\frac{E\Delta t}{\Delta x^2})$$

Implicit methods need ALL THE CELLS. So lets not do that...

$$\frac{u^{n+1}-2u^n+u^{n-1}}{\Delta t^2}-\frac{D}{\Delta x^2}(u^n_{x+1}-2u^n+u^n_{x-1})-\frac{D}{\Delta y^2}(u^n_{y+1}-2u^n+u^n_{y-1})-\\
\frac{E}{\Delta x^2\Delta t}(u^{n}_{x+1}-2u^{n}+u^{n}_{x-1})+\frac{E}{\Delta x^2\Delta t}(u^{n-1}_{x+1}-2u^{n-1}+u^{n-1}_{x-1})-\\
\frac{E}{\Delta y^2\Delta t}(u^{n}_{y+1}-2u^{n}+u^{n}_{y-1})+
\frac{E}{\Delta y^2\Delta t}(u^{n-1}_{y+1}-2u^{n-1}+u^{n-1}_{y-1})-f(x,y)=0$$

Mark
$$G_x=\frac{\Delta t^2 D}{\Delta x^2},G_y=\frac{\Delta t^2 D}{\Delta y^2}\\
H_x=\frac{\Delta t E}{\Delta x^2},H_y=\frac{\Delta t E}{\Delta y^2}$$

$$u^{n+1}=2u^n-u^{n-1}+G_x(u^n_{x+1}-2u^n+u^n_{x-1})+G_y(u^n_{y+1}-2u^n+u^n_{y-1})+\\
H_x(u^{n}_{x+1}-2u^{n}+u^{n}_{x-1})-H_x(u^{n-1}_{x+1}-2u^{n-1}+u^{n-1}_{x-1})+\\
H_y(u^{n}_{y+1}-2u^{n}+u^{n}_{y-1})-
H_y(u^{n-1}_{y+1}-2u^{n-1}+u^{n-1}_{y-1})-\Delta t^2 f(x,y)$$

$$u^{n+1}=2u^n-u^{n-1}+\\
(G_x+H_x)(u^n_{x+1}-2u^n+u^n_{x-1})+\\
-H_x(u^{n-1}_{x+1}-2u^{n-1}+u^{n-1}_{x-1})+\\
(G_y+H_y)(u^n_{y+1}-2u^n+u^n_{y-1})-\\
H_y(u^{n-1}_{y+1}-2u^{n-1}+u^{n-1}_{y-1})-\\
\Delta t^2 f(x,y)$$

# Some equation list

This assumes $f:=f(x,y,t)$, $u_s=u_x+u_y$

1. $u_t+a_0f=0$ - boring, nothing depends on neighbors
2. $u_t+a_0u_s+a_1f=0$
3. $u_t+a_0u_s+a_1u_{xy}+a_2f=0$
4. $u_t+a_0u_s+a_1u_{xy}+a_2f+a_3u_{ss}=0$
5. $u_{tt}+a_0u_s+a_1f=0$
6. $u_{tt}+a_0u_{st}+a_1f=0$

# Random diff eq no 4

$$u_t+a_0u_s+a_1u_{xy}+a_2f+a_3u_{ss}=0\\
  u_t+a_0u_x+a_0u_y+a_1u_{xy}+a_2f+a_3u_{xx}+a_3u_{yy}=0$$
$$u(x,y,0)=I(x,y), (x,y)\in \Omega,\\
u(x,y,0)=0, (x,y)\in \partial\Omega$$

$$\frac{u^{n+1}-u^n}{ \Delta t}\\
  +a_0\frac{u_{x+1}-u_{x-1}}{2 \Delta x}\\
  +a_0\frac{u_{y+1}-u_{y-1}}{2 \Delta y}\\
  +a_3\frac{u_{x+1}-2u_{x}+u_{x-1}}{ \Delta x}\\
  +a_3\frac{u_{y+1}-2u_{y}+u_{y-1}}{ \Delta y}\\
  +a_1\frac{u_{x+1,y+1}-u_{x+1,y-1}-u_{x-1,y+1}+u_{x-1,y-1}}{4 \Delta x\Delta y}\\
  +a_2f=0$$
$$u^{n+1}=\\
u\\
-\frac{\Delta t}{ \Delta x}(u_{x+1}({a_0\over 2}+a_3)-2a_3u+u_{x-1}(a_3-{a_0\over 2}))\\
-\frac{\Delta t}{ \Delta y}(u_{y+1}({a_0\over 2}+a_3)-2a_3u+u_{y-1}(a_3-{a_0\over 2}))\\
-\frac{a_1\Delta t}{{4 \Delta x\Delta y}}(u_{x+1,y+1}-u_{x+1,y-1}-u_{x-1,y+1}+u_{x-1,y-1})\\
-a_2\Delta t f=0$$

# Shrodinger eq

$$
\mathrm{i} \hbar \frac{\partial}{\partial t} | \,\psi (t) \rangle = \hat{H} | \,\psi (t) \rangle
$$

# Ideas and Todo

* Make a nice list (with images) of diff equations
    - images
    - equation
    - why fun
* Limit equations to "bounded" i.e. $\lim_{t\to \infty} u(x,y,t)<\infty$
* Explicit vs Implicit -> implicit needs to calculate ALL the cells thus no gpu. Mixed might be possible
	* e.g. we can do implicit "Strongly dampened waves" and then put in explicit formula for fun
* Bigger x/y stencil
* why so unstable?
* $u_{tt}=cu_{xxt}+f(x,t)$ strongly dampened wave equation
* $u_{tt}-\Delta u-\Delta u_t-f(x,t)=0$ strongly dampened wave equation
* https://en.wikipedia.org/wiki/Zakharov%E2%80%93Schulman_system
* Dispersive Long wave equation: https://www.hindawi.com/journals/isrn/2014/967176/
* https://en.wikipedia.org/wiki/Nonlinear_Schr%C3%B6dinger_equation
* https://en.wikipedia.org/wiki/Kuramoto%E2%80%93Sivashinsky_equation
* https://grail.cs.washington.edu/projects/watercolor/paper_small.pdf
* http://web.cse.ohio-state.edu/~wang.3602/Mao-2017-SBS/Mao-2017-SBS.pdf

# Refs
* Meta: https://math.meta.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference
* https://www.geometrictools.com/Documentation/FiniteDifferences.pdf
* http://hplgit.github.io/num-methods-for-PDEs/doc/pub/wave/html/._wave006.html
* https://wiki.seg.org/wiki/Mathematical_foundation_of_elastic_wave_propagation
* https://www.hindawi.com/journals/jcmp/2014/108713/
* https://www.degruyter.com/view/journals/phys/15/1/article-p300.xml#j_phys-2017-0033_ref_008_w2aab3b8e3654b1b7b1ab2ab8Aa
* https://www.math.ucdavis.edu/~temple/MAT22C/LecturesMat22CW15/7-Nonlinear_Wave_Equation-22C-W15.pdf
* https://arxiv.org/pdf/1911.00899.pdf
* https://mathworld.wolfram.com/PartialDifferentialEquation.html
* https://www.eijst.org.uk/images/frontImages/articles/Vol.7No.1/2.Exact_solutions_of_some_transonic_gas_flows_equations.pdf
* https://hplgit.github.io/fdm-book/doc/pub/diffu/pdf/diffu-4print.pdf
* Fractional derivate based wave eq: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2677360/
* watercolors ftw: https://grail.cs.washington.edu/projects/watercolor/paper_tiny.pdf
* schrodinger: https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation
* hamiltonian: https://en.wikipedia.org/wiki/Hamiltonian_(quantum_mechanics)
* Simulating schr. eq: http://www.astro.utoronto.ca/~mahajan/notebooks/quantum_tunnelling.html
* unitary time stepping needed: https://physics.stackexchange.com/questions/259134/schrodinger-equation-for-a-hamiltonian-with-explicit-time-dependence

<!-- Markdeep: --><style class="fallback">body{visibility:hidden;white-space:pre;font-family:monospace}</style><script src="markdeep.min.js" charset="utf-8"></script><script src="https://casual-effects.com/markdeep/latest/markdeep.min.js" charset="utf-8"></script><script>window.alreadyProcessedMarkdeep||(document.body.style.visibility="visible")</script>